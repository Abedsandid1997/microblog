global:
  scrape_interval: 30s

scrape_configs:
  - job_name: "node_exporter_all"
    static_configs:
      - targets:
{% for host in groups['devops'] %}
        - "{{ host }}:9100"
{% endfor %}

  - job_name: "prometheus"
    static_configs:
      - targets:
        - "0.0.0.0:9090"

  
  - job_name: "microblog"
    metrics_path: "/metrics"
    static_configs:
      - targets:
{% for host in groups['appserver'] %}
        - "{{ host }}:8000"
{% endfor %}

alerting:
  alertmanagers:
    - static_configs:
        - targets:
            - "{{ groups['monitoring'][0] }}:9093"

rule_files:
  - "/etc/prometheus/rules.yml"